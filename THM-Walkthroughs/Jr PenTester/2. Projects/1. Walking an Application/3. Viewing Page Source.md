
Within the source code certain things stood out and exposed critical flags.
They were:

### 1. Comments

A comment in the source mentioned a page which was under construction and that the present page was only temporary. 

```
<!--This page is temporary while we work on the new homepage @ /new-home-beta -->
```

This under-construction page is vulnerable to attacks and when visited displayed a flag.
Visited as: `https://10-10-44-112.p.thmlabs.com/new-home-beta`
Flag: `THM{HTML_COMMENTS_ARE_DANGEROUS}`

### 2. Exposed Link

The Secret page link was exposed in an anchor tag leading to another vulnerability. Looked as follows:
```
<p class="welcome-msg">Our dedicated staff are ready <a href="[/secret-page](https://10-10-44-112.p.thmlabs.com/secret-page)">to</a> assist you with your IT problems.</p>
```

Upon visiting this page, it displayed a flag.
Visited as: `https://10-10-44-112.p.thmlabs.com/secret-page`
Flag: `THM{NOT_A_SECRET_ANYMORE}`

### 3. Exposed Assets

All assets under use have not been restricted access to and a random website user is able to visit, view and extract it:
```
# Index of /assets/

---

[../](http://10-10-44-112.p.thmlabs.com/)
[avatars/](http://10-10-44-112.p.thmlabs.com/assets/avatars/)                                           23-Aug-2021 08:53                   -
[bootstrap.min.css](http://10-10-44-112.p.thmlabs.com/assets/bootstrap.min.css)                                  23-Aug-2021 08:53              121200
[bootstrap.min.js](http://10-10-44-112.p.thmlabs.com/assets/bootstrap.min.js)                                   23-Aug-2021 08:53               37049
[flag.txt](http://10-10-44-112.p.thmlabs.com/assets/flag.txt)                                           23-Aug-2021 08:53                  34
[flash.min.js](http://10-10-44-112.p.thmlabs.com/assets/flash.min.js)                                       23-Aug-2021 08:53                2409
[jquery.min.js](http://10-10-44-112.p.thmlabs.com/assets/jquery.min.js)                                      23-Aug-2021 08:53               89476
[printer.png](http://10-10-44-112.p.thmlabs.com/assets/printer.png)                                        23-Aug-2021 08:53              154361
[shakinghands.png](http://10-10-44-112.p.thmlabs.com/assets/shakinghands.png)                                   23-Aug-2021 08:53              230418
[site.js](http://10-10-44-112.p.thmlabs.com/assets/site.js)                                            23-Aug-2021 08:53                 408
[staff.png](http://10-10-44-112.p.thmlabs.com/assets/staff.png)                                          23-Aug-2021 08:53              528156
[style.css](http://10-10-44-112.p.thmlabs.com/assets/style.css)                                          23-Aug-2021 08:53                6415
```

Upon visiting this page, the flag.txt was visible in clear words and ready to extract.
Visited as: `https://10-10-44-112.p.thmlabs.com/secret-page`
Flag: `THM{INVALID_DIRECTORY_PERMISSIONS}`

### 4. Exposed Assets

All assets under use have not been restricted access to and a random website user is able to visit, view and extract it:
```
# Index of /assets/

---

[../](http://10-10-44-112.p.thmlabs.com/)
[avatars/](http://10-10-44-112.p.thmlabs.com/assets/avatars/)                                           23-Aug-2021 08:53                   -
[bootstrap.min.css](http://10-10-44-112.p.thmlabs.com/assets/bootstrap.min.css)                                  23-Aug-2021 08:53              121200
[bootstrap.min.js](http://10-10-44-112.p.thmlabs.com/assets/bootstrap.min.js)                                   23-Aug-2021 08:53               37049
[flag.txt](http://10-10-44-112.p.thmlabs.com/assets/flag.txt)                                           23-Aug-2021 08:53                  34
[flash.min.js](http://10-10-44-112.p.thmlabs.com/assets/flash.min.js)                                       23-Aug-2021 08:53                2409
[jquery.min.js](http://10-10-44-112.p.thmlabs.com/assets/jquery.min.js)                                      23-Aug-2021 08:53               89476
[printer.png](http://10-10-44-112.p.thmlabs.com/assets/printer.png)                                        23-Aug-2021 08:53              154361
[shakinghands.png](http://10-10-44-112.p.thmlabs.com/assets/shakinghands.png)                                   23-Aug-2021 08:53              230418
[site.js](http://10-10-44-112.p.thmlabs.com/assets/site.js)                                            23-Aug-2021 08:53                 408
[staff.png](http://10-10-44-112.p.thmlabs.com/assets/staff.png)                                          23-Aug-2021 08:53              528156
[style.css](http://10-10-44-112.p.thmlabs.com/assets/style.css)                                          23-Aug-2021 08:53                6415
```

Upon visiting this page, the flag.txt was visible in clear words and ready to extract.
Visited as: `https://10-10-44-112.p.thmlabs.com/secret-page`
Flag: `THM{INVALID_DIRECTORY_PERMISSIONS}`

### 5. Older Vulnerable Software Version in Use

All assets under use have not been restricted access to and a random website user is able to visit, view and extract it:
```
<!--Page Generated in 0.04025 Seconds using the THM Framework v1.2 ( https://static-labs.tryhackme.cloud/sites/thm-web-framework ) -->
```

Upon visiting this page, it was evident that v1.2 was in use however, a patched v1.3 was present. The vulnerability of v1.2 was that the backup process was creating a file in the web directory called /tmp.zip which potentially could of been read by website visitors. This file is now stored in an area that is unreadable by the public.

Visited as: `https://static-labs.tryhackme.cloud/sites/thm-web-framework/` > `https://static-labs.tryhackme.cloud/sites/thm-web-framework/changelog.html` > ``
Flag: `THM{KEEP_YOUR_SOFTWARE_UPDATED}`
